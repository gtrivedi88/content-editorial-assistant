<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap Fix Validation</title>
    <!-- PatternFly 5 CSS (like the main app) -->
    <link rel="stylesheet" href="https://unpkg.com/@patternfly/patternfly@5/patternfly.css" />
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .code { font-family: monospace; background-color: #f8f9fa; padding: 5px; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>üîß Bootstrap Dependency Fix</h1>
    <p>This page tests that tooltip functionality works without requiring Bootstrap.</p>
    
    <div class="test-case">
        <h3>Test Elements</h3>
        <p>Hover over these elements to see tooltips:</p>
        
        <!-- Test confidence badge with tooltip -->
        <span class="pf-v5-c-label pf-m-compact pf-m-green" title="Confidence: 85% - HIGH">
            <span class="pf-v5-c-label__content">
                <i class="fas fa-check-circle pf-v5-u-mr-xs"></i>
                85%
            </span>
        </span>
        
        <span class="pf-v5-c-label pf-m-compact pf-m-orange" title="Confidence: 60% - MEDIUM" style="margin-left: 10px;">
            <span class="pf-v5-c-label__content">
                <i class="fas fa-exclamation-triangle pf-v5-u-mr-xs"></i>
                60%
            </span>
        </span>
        
        <span class="pf-v5-c-label pf-m-compact pf-m-red" title="Confidence: 30% - LOW" style="margin-left: 10px;">
            <span class="pf-v5-c-label__content">
                <i class="fas fa-question-circle pf-v5-u-mr-xs"></i>
                30%
            </span>
        </span>
    </div>
    
    <div id="test-results" class="test-case">
        <h3>üß™ Test Results</h3>
        <div id="bootstrap-check"></div>
        <div id="tooltip-check"></div>
        <div id="console-check"></div>
    </div>
    
    <script>
        // Simulate the tooltip initialization from core.js (fixed version)
        function initializeTooltips() {
            // Check if Bootstrap is available (some pages may not have it)
            if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
                var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                    return new bootstrap.Tooltip(tooltipTriggerEl);
                });
                return 'bootstrap';
            } else {
                // Fallback: Use PatternFly-style tooltips if Bootstrap is not available
                const tooltipElements = document.querySelectorAll('[data-bs-toggle="tooltip"], [title]');
                tooltipElements.forEach(function(element) {
                    if (element.hasAttribute('title') && !element.hasAttribute('data-tooltip-initialized')) {
                        element.setAttribute('data-tooltip-initialized', 'true');
                        
                        element.addEventListener('mouseenter', function() {
                            const tooltipText = this.getAttribute('title') || this.getAttribute('data-bs-title');
                            if (!tooltipText) return;
                            
                            const tooltip = document.createElement('div');
                            tooltip.className = 'pf-v5-c-tooltip';
                            tooltip.textContent = tooltipText;
                            tooltip.style.position = 'absolute';
                            tooltip.style.background = 'rgba(0,0,0,0.8)';
                            tooltip.style.color = 'white';
                            tooltip.style.padding = '0.5rem';
                            tooltip.style.borderRadius = '4px';
                            tooltip.style.fontSize = '0.875rem';
                            tooltip.style.zIndex = '9999';
                            tooltip.style.pointerEvents = 'none';
                            tooltip.style.maxWidth = '200px';
                            tooltip.style.wordWrap = 'break-word';
                            
                            document.body.appendChild(tooltip);
                            
                            const rect = this.getBoundingClientRect();
                            tooltip.style.left = rect.left + 'px';
                            tooltip.style.top = (rect.top - tooltip.offsetHeight - 5) + 'px';
                            
                            this._tooltip = tooltip;
                        });
                        
                        element.addEventListener('mouseleave', function() {
                            if (this._tooltip) {
                                this._tooltip.remove();
                                this._tooltip = null;
                            }
                        });
                    }
                });
                return 'patternfly';
            }
        }

        function runTests() {
            const resultsContainer = document.getElementById('test-results');
            
            // Test 1: Check Bootstrap availability
            const bootstrapAvailable = typeof bootstrap !== 'undefined';
            document.getElementById('bootstrap-check').innerHTML = `
                <strong>Bootstrap Check:</strong> 
                ${bootstrapAvailable 
                    ? '<span style="color: green;">‚úÖ Available (will use Bootstrap tooltips)</span>'
                    : '<span style="color: blue;">‚ÑπÔ∏è Not available (will use PatternFly fallback)</span>'}
            `;
            
            // Test 2: Initialize tooltips without error
            let tooltipMethod = '';
            let tooltipError = null;
            try {
                tooltipMethod = initializeTooltips();
                document.getElementById('tooltip-check').innerHTML = `
                    <strong>Tooltip Initialization:</strong> 
                    <span style="color: green;">‚úÖ Success (using ${tooltipMethod})</span>
                `;
            } catch (e) {
                tooltipError = e;
                document.getElementById('tooltip-check').innerHTML = `
                    <strong>Tooltip Initialization:</strong> 
                    <span style="color: red;">‚ùå Failed: ${e.message}</span>
                `;
            }
            
            // Test 3: Check for console errors
            const originalConsoleError = console.error;
            let consoleErrors = [];
            console.error = function(...args) {
                consoleErrors.push(args.join(' '));
                originalConsoleError.apply(console, args);
            };
            
            setTimeout(() => {
                console.error = originalConsoleError;
                document.getElementById('console-check').innerHTML = `
                    <strong>Console Errors:</strong> 
                    ${consoleErrors.length === 0 
                        ? '<span style="color: green;">‚úÖ No errors detected</span>'
                        : '<span style="color: red;">‚ùå Errors: ' + consoleErrors.join(', ') + '</span>'}
                `;
                
                // Overall result
                const success = !tooltipError && consoleErrors.length === 0;
                const overallResult = document.createElement('div');
                overallResult.style.marginTop = '20px';
                overallResult.style.padding = '15px';
                overallResult.style.border = '2px solid ' + (success ? 'green' : 'red');
                overallResult.style.borderRadius = '5px';
                overallResult.style.backgroundColor = success ? '#d4edda' : '#f8d7da';
                overallResult.innerHTML = `
                    <h4>${success ? 'üéâ All Tests Passed!' : '‚ö†Ô∏è Tests Failed'}</h4>
                    <p>${success 
                        ? 'The Bootstrap dependency issue has been fixed. Tooltips work with or without Bootstrap.'
                        : 'There are still issues with the tooltip implementation.'}</p>
                `;
                resultsContainer.appendChild(overallResult);
            }, 100);
        }

        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>